// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Auth from "./Auth.res.mjs";
import * as Meta from "./Meta.res.mjs";
import * as Browser from "./Browser.res.mjs";
import * as Core__Option from "@rescript/core/src/Core__Option.res.mjs";

async function make_field(form, field) {
  var label = Browser.makeElement("label");
  label.for = field.id;
  label.innerText = field.label;
  form.appendChild(label);
  form.appendChild(Browser.makeElement("br"));
  if (field.type === "select") {
    var options = Core__Option.getExn(field.options, "[FormBuilder.make_field] Options not defined for select field " + field.id);
    var reference = Core__Option.getExn(options.reference, "[FormBuilder.make_field] Reference not defined for select field " + field.id);
    var get_options = Auth.make_get_options();
    var related = await globalThis.fetch(Meta.schema.system.constants.root_url + "/" + reference, get_options);
    var array = await related.json();
    var select = Browser.makeElement("select");
    select.id = field.id;
    select.name = field.id;
    array.forEach(function (option) {
          var element = Browser.makeElement("option");
          element.value = option.id;
          element.innerText = option.name;
          select.appendChild(element);
        });
    form.appendChild(select);
    form.appendChild(Browser.makeElement("br"));
    return ;
  }
  var input = Browser.makeElement("input");
  input.type = field.type;
  input.id = field.id;
  input.name = field.id;
  form.appendChild(input);
  form.appendChild(Browser.makeElement("br"));
}

function make_submit_button(form, text) {
  var button = Browser.makeElement("input");
  button.type = "submit";
  button.value = text;
  form.appendChild(button);
}

async function make_form(fields, id) {
  var form = Browser.makeElement("form");
  for(var i = 0 ,i_finish = fields.length; i < i_finish; ++i){
    var field = Core__Option.getExn(fields[i], "[FormBuilder.make_form] Field on index " + String(i) + " should not be None");
    await make_field(form, field);
  }
  make_submit_button(form, "Enviar");
  form.id = id;
  return form;
}

export {
  make_field ,
  make_submit_button ,
  make_form ,
}
/* No side effect */
